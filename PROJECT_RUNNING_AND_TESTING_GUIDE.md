# 项目运行和测试指南

## 1. 项目概述

SmartGuide AI 是一个基于智谱AI的智能客服系统，为商家提供了全方位的产品支持解决方案。系统包含商家后台和用户端两个主要部分，支持文本聊天、语音识别、图片分析、视频聊天和OCR文字识别等多种功能。

### 主要功能

- **文本聊天**：基于知识库的智能问答
- **语音识别**：支持语音输入和语音合成
- **图片分析**：支持上传图片并进行多模态分析
- **视频聊天**：支持实时视频通话和屏幕标注
- **OCR文字识别**：支持识别图片中的文字
- **项目管理**：商家可以创建和管理多个产品项目
- **知识库管理**：支持添加和管理产品知识库
- **数据分析**：提供使用数据分析和统计

## 2. 安装指南

### 2.1 系统要求

- Node.js 16.0 或更高版本
- npm 7.0 或更高版本
- 现代浏览器（Chrome、Firefox、Safari、Edge）

### 2.2 安装步骤

1. **克隆项目**

   ```bash
   git clone <项目地址>
   cd <项目目录>
   ```

2. **安装依赖**

   ```bash
   npm install
   ```

3. **配置环境变量**

   复制 `.env.example` 文件并重命名为 `.env.local`，然后填写智谱AI API密钥：

   ```
   ZHIPU_API_KEY=your_zhipu_api_key_here
   ```

## 3. 运行方法

### 3.1 开发服务器

启动开发服务器，用于开发和测试：

```bash
npm run dev
```

服务器将在 `http://localhost:3001/` 运行。

### 3.2 生产构建

构建生产版本，用于部署：

```bash
npm run build
```

构建结果将输出到 `dist` 目录。

### 3.3 预览生产构建

预览生产构建结果：

```bash
npm run preview
```

## 4. 功能测试

### 4.1 商家后台测试

1. **访问商家后台**

   打开浏览器，访问 `http://localhost:3001/`，即可进入商家后台。

2. **测试项目管理**

   - 创建新项目
   - 编辑项目配置
   - 查看项目列表
   - 删除项目

3. **测试知识库管理**

   - 添加知识库条目
   - 编辑知识库条目
   - 删除知识库条目
   - 搜索知识库

4. **测试数据分析**

   - 查看使用统计
   - 分析用户行为

### 4.2 用户端测试

1. **访问用户端**

   打开浏览器，访问 `http://localhost:3001/view/<项目ID>`，其中 `<项目ID>` 是商家创建的项目ID。

   系统已预置三个测试项目：
   - 测试项目：`http://localhost:3001/view/p1`
   - SmartHome Pro Hub：`http://localhost:3001/view/proj_1`
   - SmartThermostat：`http://localhost:3001/view/proj_2`

2. **测试文本聊天**

   - 在输入框中输入问题
   - 点击发送按钮或按回车键
   - 查看AI的回复

3. **测试语音识别**

   - 点击麦克风按钮开始录音
   - 说出问题
   - 再次点击麦克风按钮停止录音
   - 查看语音识别结果和AI的回复

4. **测试语音合成**

   - 在AI回复下方点击 "Audio 播放语音" 按钮
   - 聆听语音合成结果

5. **测试图片上传和分析**

   - 点击相机按钮
   - 选择一张图片上传
   - 查看AI的图片分析结果

6. **测试OCR文字识别**

   - 上传包含文字的图片
   - 查看OCR识别结果

7. **测试视频聊天**

   - 点击视频按钮
   - 允许浏览器访问摄像头和麦克风
   - 开始视频聊天
   - 使用标注工具在视频上添加标注
   - 结束视频聊天

## 5. API配置

### 5.1 智谱AI API密钥

系统使用智谱AI的API进行语音识别、语音合成、图片分析、视频聊天和OCR文字识别。需要在 `.env.local` 文件中配置智谱AI API密钥：

```
ZHIPU_API_KEY=your_zhipu_api_key_here
```

### 5.2 支持的智谱AI模型

- **文本聊天**：glm-4.7
- **语音识别**：glm-4-voice
- **语音合成**：glm-tts
- **图片分析**：glm-4.6v
- **视频聊天**：glm-realtime-flash
- **OCR文字识别**：智谱OCR服务
- **向量嵌入**：embedding-3

## 6. 故障排除

### 6.1 常见问题

1. **API密钥错误**

   - 症状：系统提示 "AI服务配置异常" 或 "缺少API密钥"
   - 解决方法：检查 `.env.local` 文件中的智谱AI API密钥是否正确

2. **网络连接错误**

   - 症状：系统提示 "网络连接异常" 或 "服务错误"
   - 解决方法：检查网络连接是否正常，确保可以访问智谱AI API

3. **媒体设备权限错误**

   - 症状：系统提示 "无法访问摄像头或麦克风" 或 "权限被拒绝"
   - 解决方法：在浏览器设置中允许访问摄像头和麦克风

4. **视频聊天连接错误**

   - 症状：系统提示 "GLM-Realtime连接失败" 或 "连接超时"
   - 解决方法：检查网络连接是否稳定，确保智谱AI API密钥有效

5. **OCR处理错误**

   - 症状：系统提示 "OCR处理失败" 或 "识别中..."
   - 解决方法：检查上传的图片是否清晰，确保智谱AI API密钥有效

### 6.2 调试建议

1. **查看浏览器控制台**

   打开浏览器开发者工具，查看控制台中的错误信息，了解具体的错误原因。

2. **检查网络请求**

   在浏览器开发者工具的网络选项卡中，查看API请求的状态和响应，了解是否有网络错误。

3. **测试智谱AI API**

   使用 `test-api.js` 文件测试智谱AI API是否正常工作：

   ```bash
   node test-api.js
   ```

4. **检查项目ID**

   确保访问的项目ID存在且状态为 "active"。

## 7. 测试用例

### 7.1 文本聊天测试用例

1. **基本问答**
   - 输入："你好"
   - 预期输出：问候语和自我介绍

2. **知识库问答**
   - 输入："如何设置SmartHome Pro Hub？"
   - 预期输出：基于知识库的详细设置步骤

3. **多轮对话**
   - 输入1："什么是SmartHome Pro Hub？"
   - 输入2："它有什么功能？"
   - 预期输出：连贯的多轮对话回复

### 7.2 语音识别测试用例

1. **基本语音输入**
   - 语音："你好，请介绍一下这个产品"
   - 预期输出：正确识别语音内容并生成相应回复

2. **复杂语音输入**
   - 语音："我想了解如何安装SmartHome Pro Hub，需要哪些步骤？"
   - 预期输出：正确识别语音内容并基于知识库生成安装步骤

### 7.3 图片分析测试用例

1. **产品图片分析**
   - 上传：产品图片
   - 预期输出：识别产品型号和基本信息

2. **安装场景分析**
   - 上传：安装场景图片
   - 预期输出：分析安装是否正确，提供改进建议

### 7.4 视频聊天测试用例

1. **基本视频聊天**
   - 操作：开始视频聊天
   - 预期结果：成功建立视频连接，实时传输视频和音频

2. **标注功能测试**
   - 操作：在视频上添加箭头、圆圈、文本和高亮标注
   - 预期结果：标注实时显示在视频上，AI能够识别和回应标注内容

### 7.5 OCR文字识别测试用例

1. **印刷体文字识别**
   - 上传：包含印刷体文字的图片
   - 预期输出：正确识别文字内容

2. **手写体文字识别**
   - 上传：包含手写体文字的图片
   - 预期输出：正确识别手写体文字内容

## 8. 性能优化

### 8.1 前端优化

- **代码分割**：使用动态导入减少初始加载时间
- **图片优化**：使用适当的图片格式和大小
- **缓存策略**：缓存API响应和静态资源
- **懒加载**：延迟加载非关键资源

### 8.2 后端优化

- **API调用优化**：减少API调用次数，批量处理请求
- **数据库优化**：使用索引和缓存提高查询性能
- **并发处理**：优化并发请求处理

## 9. 部署建议

### 9.1 本地部署

- 使用 `npm run build` 构建生产版本
- 使用 `npm run preview` 本地预览生产版本

### 9.2 云服务器部署

- 构建生产版本：`npm run build`
- 上传 `dist` 目录到云服务器
- 使用Nginx或Apache配置静态文件服务
- 配置HTTPS证书

### 9.3 容器化部署

- 创建Dockerfile：

  ```Dockerfile
  FROM node:16-alpine
  WORKDIR /app
  COPY package*.json ./
  RUN npm install
  COPY . .
  RUN npm run build
  EXPOSE 80
  CMD ["npm", "run", "preview", "--", "--port", "80"]
  ```

- 构建和运行容器：

  ```bash
  docker build -t smartguide-ai .
  docker run -p 80:80 smartguide-ai
  ```

## 10. 总结

SmartGuide AI 是一个功能强大的智能客服系统，为商家提供了全方位的产品支持解决方案。通过本指南，您可以了解如何安装、运行和测试系统的各项功能。如果遇到问题，请参考故障排除部分或联系技术支持。

---

**技术支持**：400-888-6666
**邮箱**：support@example.com
**微信公众号**：AI虚拟客服助手

© 2024 中恒创世科技有限公司 版权所有